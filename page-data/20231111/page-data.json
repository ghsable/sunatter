{"componentChunkName":"component---src-templates-blog-post-js","path":"/20231111/","result":{"data":{"site":{"siteMetadata":{"title":"sunatter"}},"markdownRemark":{"id":"cfc17979-ab45-5000-aee3-74490eee4445","excerpt":"しばらく先の私に向けた戦記を残しておきます。NixOS で Immersed を完動させることが最終目的です。（NixOS 以外のユーザが読まれてもあまり意味が無いかもしれません。） Immersed のLinux版（例: ）を実行するには、（AppImage を実行）が要ります。 取得した AppImage…","html":"<p>しばらく先の私に向けた戦記を残しておきます。<a href=\"https://nixos.org/\">NixOS</a> で <a href=\"https://immersed.com/\">Immersed</a> を完動させることが最終目的です。（<a href=\"https://nixos.org/\">NixOS</a> 以外のユーザが読まれてもあまり意味が無いかもしれません。）</p>\n<p><a href=\"https://immersed.com/\">Immersed</a> のLinux版（例: <code class=\"language-text\">Immersed-x86_64.AppImage</code>）を実行するには、<code class=\"language-text\">appimage-run</code>（<a href=\"https://appimage.org/\">AppImage</a> を実行）が要ります。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ nix-shell <span class=\"token parameter variable\">-p</span> appimage-run</code></pre></div>\n<p>取得した <a href=\"https://appimage.org/\">AppImage</a> にユーザの実行権限を付与します。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token function\">chmod</span> <span class=\"token parameter variable\">--verbose</span> u+x Immersed-x86_64.AppImag\nmode of <span class=\"token string\">'Immersed-x86_64.AppImage'</span> changed from 0644 <span class=\"token punctuation\">(</span>rw-r--r--<span class=\"token punctuation\">)</span> to 0744 <span class=\"token punctuation\">(</span>rwxr--r--<span class=\"token punctuation\">)</span></code></pre></div>\n<p>実行するとエラー（<code class=\"language-text\">libthai.so.0</code>が見つからない）が出ると思います。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ appimage-run Immersed-x86_64.AppImage\nImmersed: error <span class=\"token keyword\">while</span> loading shared libraries: libthai.so.0: cannot <span class=\"token function\">open</span> shared object file: No such <span class=\"token function\">file</span> or directory</code></pre></div>\n<p>そのため、環境変数「<code class=\"language-text\">LD_LIBRARY_PATH</code>」に<code class=\"language-text\">libthai.so.0</code>（<a href=\"https://linux.thai.net/projects/libthai/\">libthai Library</a>）のあるパスを通します。（以下、バージョンは読み替えてください。）</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ <span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LD_LIBRARY_PATH</span><span class=\"token operator\">=</span>/nix/store/hashcode-libthai-0.1.29/lib</code></pre></div>\n<p>リラン。先ほどのエラーは解消されましたが、新たなエラー（<code class=\"language-text\">GLIBC_2.38</code>が見つからない）が出ると思います。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ appimage-run Immersed-x86_64.AppImage\nps: /usr/lib/libc.so.6: version <span class=\"token variable\"><span class=\"token variable\">`</span>GLIBC_2.38' not found <span class=\"token punctuation\">(</span>required by <span class=\"token function\">ps</span><span class=\"token punctuation\">)</span>\nps: /usr/lib/libc.so.6: version <span class=\"token variable\">`</span></span>GLIBC_2.38' not found <span class=\"token punctuation\">(</span>required by /nix/store/hashcode-procps-3.3.17/lib/libprocps.so.8</code></pre></div>\n<p><a href=\"https://www.gnu.org/software/libc/\">glibc</a> のバージョン<code class=\"language-text\">2.38</code>が見つからないようです。現時点においてnix packagesのstable版（<code class=\"language-text\">23.05</code>）は「Version: <code class=\"language-text\">2.37-45</code>」に対し、unstable版は「Version: <code class=\"language-text\">2.38-23</code>」です。</p>\n<p>ということで<code class=\"language-text\">channel</code>を<code class=\"language-text\">nixpkgs-unstable</code>に向ければ良さそうです。<code class=\"language-text\">pkgs.glibc</code>を宣言したいところですが、実は <a href=\"https://nixos.org/manual/nix/stable/command-ref/nix-shell\">nix-shell</a> で<code class=\"language-text\">channel:nixpkgs-unstable</code>の環境に入れば<code class=\"language-text\">pkgs.glibc</code>の宣言は不要になります。（デフォルトの環境に含まれている様子。）</p>\n<p>したがって、このエラーは<code class=\"language-text\">shell.nix</code>（<a href=\"https://nixos.org/manual/nix/stable/command-ref/nix-shell\">nix-shell</a>）を経由することで解決します。であれば、初回のエラーをもう少しスマートに解消（組込）してみます。</p>\n<div class=\"gatsby-highlight\" data-language=\"nix\"><pre class=\"language-nix\"><code class=\"language-nix\"><span class=\"token comment\"># pkgs.appimage-runの宣言を忘れずに。</span>\n\nshellHook <span class=\"token operator\">=</span> <span class=\"token string\">''\n  export LD_LIBRARY_PATH=<span class=\"token interpolation\"><span class=\"token antiquotation important\">$</span><span class=\"token punctuation\">{</span>pkgs<span class=\"token punctuation\">.</span>libthai<span class=\"token punctuation\">}</span></span>/lib\n''</span></code></pre></div>\n<p>これでめでたく <a href=\"https://immersed.com/\">Immersed</a> のウィンドウ（GUI）を起動できると思います。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ appimage-run Immersed-x86_64.AppImage\nImmersed-x86_64.AppImage installed <span class=\"token keyword\">in</span> /home/username/.cache/appimage-run/hashcode</code></pre></div>\n<p>あとは画面の案内通りに接続先情報を入力すれば、接続先側にコンピュータがホスト名で追加されると思います。</p>\n<p><a href=\"https://www.x.org/releases/current/doc/man/man7/X.7.xhtml\">X11</a> ユーザは恐らくこれで完了かと思います。お疲れ様でした。</p>\n<p><a href=\"https://wayland.freedesktop.org/index.html\">Wayland</a> ユーザは居残りです。不穏なメッセージが表示されたかと思います。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Wayland Window System is detected. Currently we only support\nX11. Please consider to use X Window System for now.</code></pre></div>\n<p>結論、<a href=\"https://immersed.com/\">Immersed</a> は <a href=\"https://wayland.freedesktop.org/index.html\">Wayland</a> に対応していません！（ﾄﾞﾝ!!）</p>\n<p>コンポジタで <a href=\"https://wayland.freedesktop.org/xserver.html\">Xwayland</a>（<code class=\"language-text\">pkgs.xwayland</code>の宣言は不要）を有効（例: <code class=\"language-text\">disable</code>を解除）にし、<a href=\"https://manpages.org/xwininfo\">xwininfo</a>（<code class=\"language-text\">xorg.xwininfo</code>）を起動してから <a href=\"https://immersed.com/\">Immersed</a> のウィンドウをマウスホバーしてみます。するとマウスポインタが「＋」に変化したと思います。</p>\n<p>その意味は <a href=\"https://wayland.freedesktop.org/xserver.html\">Xwayland</a> 経由で（期待通りに）起動されているということになります（泣）残念ながらチェックメイトです。</p>\n<p>ちなみに <a href=\"https://www.winehq.org/\">Wine</a>（<code class=\"language-text\">wineWowPackages.waylandFull</code>）+ <a href=\"https://wiki.winehq.org/Winetricks\">Winetricks</a>（<code class=\"language-text\">winetricks</code>）では、アプリケーションの実行段階から雲行きが怪しい雰囲気です。よく忘れてしまうので、ついでに頻出のコマンドを控えておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># .exe形式の実行</span>\n$ wine プログラム名.exe\n\n<span class=\"token comment\"># .msi形式の実行</span>\n$ wine msiexec /i プログラム名.msi\n\n<span class=\"token comment\"># Wine本体の設定（Windowsのバージョンなど）</span>\n$ winecfg\n\n<span class=\"token comment\"># Wineからインストールしたアプリケーション（~/.wine/drive_c/）をアンインストール</span>\n$ wine uninstaller</code></pre></div>\n<p>一筋の光が公式より「<a href=\"https://wayland.freedesktop.org/index.html\">Wayland</a> は将来的にサポート予定」とのことです。いつになるのか分かりませんが、そのときが来たらこの続きから着手しようかなと思います。</p>\n<ul>\n<li><a href=\"https://immersed.zendesk.com/hc/en-us/articles/14226089686157-Supported-Computers-Headsets\">Supported Computers &#x26; Headsets</a></li>\n</ul>","frontmatter":{"title":"20231111","date":"November 11, 2023","description":null}},"previous":{"fields":{"slug":"/20231108/"},"frontmatter":{"title":"20231108"}},"next":{"fields":{"slug":"/20231118/"},"frontmatter":{"title":"20231118"}}},"pageContext":{"id":"cfc17979-ab45-5000-aee3-74490eee4445","previousPostId":"5d2d1ace-294e-51e6-8ee6-b37424733173","nextPostId":"8e6232e6-5428-5dfc-b8ae-b50013d6912b"}},"staticQueryHashes":["2841359383"],"slicesMap":{}}